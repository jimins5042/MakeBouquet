<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Image Gallery</title>
    <style>
        .container {
            display: flex;
            flex-direction: row;
            width: 100%;
            height: 100vh; /* 화면 전체 높이를 차지하도록 설정 */
        }

        .thumbnails {
            width: 30%;
            height: 100%; /* 전체 높이를 차지하도록 설정 */
            overflow-y: auto; /* 스크롤 가능하도록 설정 */
            display: flex;
            flex-direction: column;
            align-items: center;
            border-right: 1px solid #ccc; /* 오른쪽 경계선 추가 */
            padding-right: 10px;
        }

        .thumbnails img {
            width: 80%;
            margin: 10px 0;
            cursor: pointer;
        }

        .large-image {
            width: 70%;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden; /* 이미지가 영역을 벗어나지 않도록 설정 */
        }

        .large-image img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain; /* 이미지 비율을 유지하면서 영역에 맞게 조정 */
        }
    </style>
</head>
<body>
<div class="container">
    <!-- 왼쪽 썸네일 리스트 -->
    <div class="thumbnails">
        <div th:each="image : ${images}">
            <img th:src="@{${image}}" th:alt="'Image ' + ${image}" onclick="showLargeImage(this)">
        </div>
    </div>

    <!-- 오른쪽 큰 이미지 표시 -->
    <div class="large-image">
        <img id="largeImage" th:src="@{${images[0]}}">
        <button onclick="redirectToPage()">이미지 전송</button> <!-- 버튼 추가 -->
    </div>
</div>

<script>
    function showLargeImage(element) {
        var largeImage = document.getElementById('largeImage');
        largeImage.src = element.src;
    }

    function redirectToPage() {
        var largeImage = document.getElementById('largeImage');
        var imageUrl = largeImage.src;

        // FormData 객체에 이미지 URL을 담기
        var formData = new FormData();
        formData.append('image', imageUrl);

        fetch('/flower/decorate', {
            method: 'POST',
            body: formData
        })
            .then(response => {
                if (response.ok) {
                    window.location.href = '/flower/decorate';
                } else {
                    console.error('File upload failed');
                }
            })
            .catch(error => console.error('Error:', error));

    }

    const storageKeys = ["savedImage1", "savedImage2", "savedImage3"];

    for (let key in storageKeys) {

        console.log(localStorage.getItem(key));
    }

</script>
</body>
</html>
